<!DOCTYPE html>
<html>
<head>
    <title>Просмотр данных Excel</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 20px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>Данные из Excel</h1>

    {% if data %}
        <table>
            <thead>
                <tr>
                    {% for column in column_names %}
                        <th>{{ column }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for row in data %}
                    <tr>
                        {% for column in column_names %}
                            <td>{{ row.get(column, '') }}</td>  <!-- Обработка отсутствующих ключей -->
                        {% endfor %}
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>Нет данных для отображения.</p>
    {% endif %}
</body>
</html><!DOCTYPE html>
<html>
<head>
    <title>Просмотр данных Excel</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 20px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>Данные из Excel</h1>

    {% if data %}
        <table>
            <thead>
                <tr>
                    {% for column in column_names %}
                        <th>{{ column }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for row in data %}
                    <tr>
                        {% for column in column_names %}
                            <td>{{ row.get(column, '') }}</td>  <!-- Обработка отсутствующих ключей -->
                        {% endfor %}
                    </tr>
                {% endfor %}
            </tbody><!DOCTYPE html>
            <html>
            <head>
                <title>Просмотр данных Excel</title>
                <style>
                    body {
                        font-family: sans-serif;
                        margin: 20px;
                    }
                    table {
                        border-collapse: collapse;
                        width: 100%;
                    }
                    th, td {
                        border: 1px solid #ddd;
                        padding: 8px;
                        text-align: left;
                    }
                    th {
                        background-color: #f2f2f2;
                    }
                </style>
            </head>
            <body>
                <h1>Данные из Excel</h1>
            
                {% if data %}
                    <table>
                        <thead>
                            <tr>
                                {% for column in column_names %}
                                    <th>{{ column }}</th>
                                {% endfor %}
                            </tr>
                        </thead>
                        <tbody>
                            {% for row in data %}
                                <tr>
                                    {% for column in column_names %}
                                        <td>{{ row.get(column, '') }}</td>
                                    {% endfor %}
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <p>Нет данных для отображения.</p>
                {% endif %}
            </body>
            </html>
        </table>
    {% else %}
        <p>Нет данных для отображения.</p>
    {% endif %}
</body>
</html>